/*	
* FitText.js 1.0
*
* Copyright 2011, Dave Rupert http://daverupert.com
* Released under the WTFPL license 
* http://sam.zoy.org/wtfpl/
*
* Date: Thu May 05 14:23:00 2011 -0600
*/
(function(a){a.fn.fitText=function(d,b){var c={minFontSize:Number.NEGATIVE_INFINITY,maxFontSize:Number.POSITIVE_INFINITY};return this.each(function(){var e=a(this);var g=d||1;if(b){a.extend(c,b)}var f=function(){var h=Math.max(Math.min(e.width()/(g*10),parseFloat(c.maxFontSize)),parseFloat(c.minFontSize));e.css("font-size",h);e.css("line-height",h+"px")};f();a(window).resize(f)})}})(jQuery);var redraw_timeout;function redraw_graph_delay(){clearTimeout(redraw_timeout);redraw_timeout=setTimeout("redraw_graph();",300)}function redraw_graph(){var b=$("#temperature_graph");var d=Math.min(Math.max(100,b.parent().width()-5),800);var a=Math.min(300,d);b.data("width",d);b.data("height",a);var c=b.data("src")+"?newtimestamp="+(new Date()).getTime()+"&width="+b.data("width")+"&height="+b.data("height")+"&range="+b.data("range");$("#temperature_graph").attr("src",c)}function fetch_data(){var b=$("body").data("pagerefresh-data").content;$("#bigtext").fitText(0.5,{minFontSize:30,maxFontSize:300});$("#etacalc").html("");if(b.autofill.sauna_trend=="warming"){for(key in b.sauna_eta_temperatures){var a=b.sauna_eta_temperatures[key];if(a[1]>0&&a[1]<7200){$("#etacalc").html(Math.floor(a[1]/60)+" minutes to "+a[0]+"&deg;C")}}}redraw_graph()}$(document).ready(function(){$("#bigtext").fitText(0.5,{minFontSize:30,maxFontSize:300});$("#update_data").pagerefresh({short_timeout:1*60,long_timeout:15*60,filewatch:"sauna.json"});$(".graph-timerange").click(function(){var a=$("#temperature_graph");a.data("range",$(this).data("timeh"));redraw_graph()});$(window).resize(function(){redraw_graph_delay()})});