$(document).ready(function(){$("#update_data").pagerefresh({short_timeout:15*60,long_timeout:120*60,filewatch:"ittickets.json"})});function fetch_data(){var f=$("#workflowchart"),g=$("#dotschart"),d=$("#placeholder"),b=$("body").data("pagerefresh-data").content.data;function a(){$("body").data("ittickets-initialized",true);f.slideUp();f.empty();g.empty();$("#emailpieholder").empty();c(b.dots.all);var h=$("#total-tickets-popover");h.data("content","This is the total number of tickets since March 2010 ("+moment("2010-03-15","YYYY-MM-DD").fromNow()+"), including automatic messages");h.data("original-title","What?");h.data("placement","top");h.attr("rel","popover");hide_popovers();h.popover({placement:popover_placement});$("#dots_all").addClass("active")}function c(h){g.empty();var m=Raphael("dotschart");var j=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],l=[];data=h.date_stats,axisy=h.ytitles;axisx=h.xtitles;for(var n=0;n<7;n++){for(var k=0;k<24;k++){l.push(n)}}m.dotchart(10,10,900,300,j,l.reverse(),data,{symbol:"o",max:10,heat:true,axis:"0 0 1 1",axisxstep:23,axisystep:6,axisxlabels:axisx,axisxtype:" ",axisytype:" ",axisylabels:axisy.reverse()}).hover(function(){this.marker=this.marker||m.tag(this.x,this.y,this.value,0,this.r+2).insertBefore(this);this.marker.show()},function(){this.marker&&this.marker.hide()})}function e(){for(var j in b){if($("#"+j)!=null){$("#"+j).html(b[j])}}$(".dots-btn").click(function(){if($(this).hasClass("active")){return}g.show();f.slideUp();var m=$(this).data("name");c(b.dots[m]);d.html("mouse over the circles for more details");d.removeClass("hidden");$("#name2").addClass("hidden")});$("#change_graph").click(function(){d.html("mouse over the graph for more details");g.slideUp();f.html("");process(b.workflow);f.removeClass("hidden");f.slideDown()});$("#emailpieholder").empty();var l=[b.other_users,b.futurice_users],i={legend:["External %%.%%","Internal %%.%%"],legendpos:"west"};var k=Raphael("emailpieholder",400,200),h=k.piechart(190,100,69,l,i);h.hover(function(){this.sector.stop();this.sector.scale(1.1,1.1,this.cx,this.cy);if(this.label){this.label[0].stop();this.label[0].attr({r:7.5});this.label[1].attr({"font-weight":800})}},function(){this.sector.animate({transform:"s1 1 "+this.cx+" "+this.cy},500,"bounce");if(this.label){this.label[0].animate({r:5},500,"bounce");this.label[1].attr({"font-weight":400})}})}if($("body").data("ittickets-initialized")!==true){a()}e()};