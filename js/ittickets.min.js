var ticketdata;$(document).ready(function(){$("#update_data").pagerefresh({short_timeout:15*60,long_timeout:120*60})});function fetch_data(){function a(){$("body").data("ittickets-initialized",true);$("#workflowchart").slideUp();$("#workflowchart").empty();$("#dotschart").empty();$("#emailpieholder").empty();$("#total-tickets-popover").data("content","This is the total number of tickets since March 2010 ("+moment("2010-03-15","YYYY-MM-DD").fromNow()+"), including automatic messages");$("#total-tickets-popover").data("original-title","What?");$("#total-tickets-popover").data("placement","top");$("#total-tickets-popover").attr("rel","popover");$("#total-tickets-popover").popover();$("#dots_all").addClass("btn-info");$("#dotschart").dotsgraph({data:ticketdata.dots.all});$("#dotschart").dotsgraph("update")}function b(){for(var d in ticketdata){if($("#"+d)!=null){$("#"+d).html(ticketdata[d])}}$(".dots-btn").click(function(){if($(this).hasClass("btn-info")){return}$("#dotschart").slideDown();$("#workflowchart").slideUp();var f=$(this).data("name");$("#dotschart").dotsgraph({data:ticketdata.dots[f]});$("#dotschart").dotsgraph("update");$(".dots-btn").removeClass("btn-info");$("#change_graph").removeClass("btn-info");$(this).addClass("btn-info");$("#placeholder").html("mouse over the circles for more details");$("#placeholder").removeClass("hidden");$("#name2").addClass("hidden")});$("#change_graph").click(function(){$("#placeholder").html("mouse over the graph for more details");$("#dotschart").slideUp();$("#workflowchart").html("");process(ticketdata.workflow);$("#workflowchart").removeClass("hidden");$("#workflowchart").slideDown();$(".dots-btn").removeClass("btn-info");$(this).addClass("btn-info")});var e=[ticketdata.other_users,ticketdata.futurice_users],c=["External","Internal"];Raphael("emailpieholder",400,200).pieChart(180,100,69,e,c,"#fff")}$.get("/ittickets.json",function(c){ticketdata=c.data;if($("body").data("ittickets-initialized")!==true){a()}b();$("#update_data").pagerefresh("fetch_done",(new Date()).getTime())})};