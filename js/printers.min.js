function fetch_data(){function a(){var k=$("body").data("pagerefresh-data").content;$("#printers").empty();$("#printers_accordion").empty();$("#printers_consumables").empty();$("#printers_papers").empty();var d=0;for(var g in k.printers){d++;var o=k.printers[g];var n="";if(o.alert_level.readable=="warning"){n='<span class="label label-warning">Warning</span>'}else{if(o.alert_level.readable=="unknown"){n='<span class="label label-default">Unknown</span>'}else{if(o.alert_level.readable=="running"){n='<span class="label label-success">Ok</span>'}else{if(o.alert_level.readable=="invalid"){n='<span class="label label-default">Unknown</span>'}else{if(o.alert_level.readable=="down"){n='<span class="label label-important">Down</span>'}else{if(o.alert_level.readable=="testing"){n='<span class="label label-info">Testing</span>'}}}}}}var i="<ul>";if(o.alert_text.length>0){for(var p in o.alert_text){i+="<li>"+o.alert_text[p]+"</li>"}}else{i+="<li>Everything is fine.</li>"}i+="</ul>";collapse_id="printers_collapse_"+d;var c="<span class='badge'>"+o.status.readable+"</span>";var b='<table class="table-striped">';var j='<table class="table-striped">';for(var p in o.consumables){var m=o.consumables[p],h="progress-danger";if(m.percentage>50){h="progress-success"}else{if(m.percentage>25){h="progress-warning"}}b+="<tr><td style='padding-right:15px'>"+m.name+"</td><td style='width:100px'><div style='margin-bottom: 3px' class='progress "+h+"'><div class='bar' style='width: "+m.percentage+"%'></div></div></td><td style='padding-left: 15px'><small>"+m.percentage+"%</small></tr>";if(m.percentage<60){j+="<tr><td style='padding-right:15px'>"+m.name+"</td><td style='width:100px'><div style='margin-bottom: 3px' class='progress "+h+"'><div class='bar' style='width: "+m.percentage+"%'></div></div></td><td style='padding-left: 15px'><small>"+m.percentage+"%</small></tr>"}}b+="</table>";j+="</table>";$("#printers_consumables").append('<div class="row" style="padding-top: 2em"><div class="span8"><h2>'+o.name+" "+n+" "+c+"</h2>"+b+"</div></div>");var l='<table class="table-striped">';var f='<table class="table-striped">';for(var p in o.papers){var e=o.papers[p],h="progress-danger";if(e.percentage>50){h="progress-success"}else{if(e.percentage>25){h="progress-warning"}}l+="<tr><td style='padding-right:15px'>"+e.name+"</td><td style='width:100px'><div style='margin-bottom: 3px' class='progress "+h+"'><div class='bar' style='width: "+e.percentage+"%'></div></div></td><td style='padding-left: 15px'><small>"+e.percentage+"%</small></td></tr>";if(e.percentage<50){f+="<tr><td style='padding-right:15px'>"+e.name+"</td><td style='width:100px'><div style='margin-bottom: 3px' class='progress "+h+"'><div class='bar' style='width: "+e.percentage+"%'></div></div></td><td style='padding-left: 15px'><small>"+e.percentage+"%</small></td></tr>"}}l+="</table>";f+="</table>";$("#printers_papers").append('<div class="row" style="padding-top: 2em"><div class="span8"><h2>'+o.name+" "+n+" "+c+"</h2>"+l+"</div></div>");$("#printers_accordion").append('<div class="accordion-group"> <div class="accordion-heading"> <h2><a style="text-decoration:none" class="accordion-toggle" data-toggle="collapse" data-parent="#printers_accordion" href="#'+collapse_id+'">'+o.name+" "+n+" "+c+"</a></h2> "+i+'</div> <div id="'+collapse_id+'" class="accordion-body collapse"> <div class="accordion-inner"> <h3>Consumables</h3> '+j+"<h3>Paper</h3> "+f+"</div> </div> </div>")}}a()}$(document).ready(function(){$("#update_data").pagerefresh({short_timeout:1*60,long_timeout:15*60,filewatch:"printers.json"})});