function fetch_data(){var k=$("body").data("pagerefresh-data").content;$("#printers").empty();$("#printers_accordion").empty();$("#printers_consumables").empty();$("#printers_papers").empty();var l=0,m;for(m in k.printers){l++;var a=k.printers[m],d="";"warning"==a.alert_level.readable?d='<span class="label label-warning">Warning</span>':"unknown"==a.alert_level.readable?d='<span class="label label-default">Unknown</span>':"running"==a.alert_level.readable?d='<span class="label label-success">Ok</span>':
"invalid"==a.alert_level.readable?d='<span class="label label-default">Unknown</span>':"down"==a.alert_level.readable?d='<span class="label label-important">Down</span>':"testing"==a.alert_level.readable&&(d='<span class="label label-info">Testing</span>');var g="<ul>";if(0<a.alert_text.length)for(var h in a.alert_text)g+="<li>"+a.alert_text[h]+"</li>";else g+="<li>Everything is fine.</li>";g+="</ul>";collapse_id="printers_collapse_"+l;var j="<span class='badge'>"+a.status.readable+"</span>",c='<table class="table-striped">',
i='<table class="table-striped">';for(h in a.consumables){var b=a.consumables[h],e="progress-danger";50<b.percentage?e="progress-success":25<b.percentage&&(e="progress-warning");c+="<tr><td style='padding-right:15px'>"+b.name+"</td><td style='width:100px'><div style='margin-bottom: 3px' class='progress "+e+"'><div class='bar' style='width: "+b.percentage+"%'></div></div></td><td style='padding-left: 15px'><small>"+b.percentage+"%</small></tr>";60>b.percentage&&(i+="<tr><td style='padding-right:15px'>"+
b.name+"</td><td style='width:100px'><div style='margin-bottom: 3px' class='progress "+e+"'><div class='bar' style='width: "+b.percentage+"%'></div></div></td><td style='padding-left: 15px'><small>"+b.percentage+"%</small></tr>")}c+="</table>";i+="</table>";$("#printers_consumables").append('<div class="row" style="padding-top: 2em"><div class="span8"><h2>'+a.name+" "+d+" "+j+"</h2>"+c+"</div></div>");b=c='<table class="table-striped">';for(h in a.papers){var f=a.papers[h],e="progress-danger";50<
f.percentage?e="progress-success":25<f.percentage&&(e="progress-warning");c+="<tr><td style='padding-right:15px'>"+f.name+"</td><td style='width:100px'><div style='margin-bottom: 3px' class='progress "+e+"'><div class='bar' style='width: "+f.percentage+"%'></div></div></td><td style='padding-left: 15px'><small>"+f.percentage+"%</small></td></tr>";50>f.percentage&&(b+="<tr><td style='padding-right:15px'>"+f.name+"</td><td style='width:100px'><div style='margin-bottom: 3px' class='progress "+e+"'><div class='bar' style='width: "+
f.percentage+"%'></div></div></td><td style='padding-left: 15px'><small>"+f.percentage+"%</small></td></tr>")}c+="</table>";b+="</table>";$("#printers_papers").append('<div class="row" style="padding-top: 2em"><div class="span8"><h2>'+a.name+" "+d+" "+j+"</h2>"+c+"</div></div>");$("#printers_accordion").append('<div class="accordion-group"> <div class="accordion-heading"> <h2><a style="text-decoration:none" class="accordion-toggle" data-toggle="collapse" data-parent="#printers_accordion" href="#'+
collapse_id+'">'+a.name+" "+d+" "+j+"</a></h2> "+g+'</div> <div id="'+collapse_id+'" class="accordion-body collapse"> <div class="accordion-inner"> <h3>Consumables</h3> '+i+"<h3>Paper</h3> "+b+"</div> </div> </div>")}}$(document).ready(function(){$("#update_data").pagerefresh({short_timeout:60,long_timeout:900,filewatch:"printers.json"})});
