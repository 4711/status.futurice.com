function getParameterByName(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+b+"=([^&#]*)";var d=new RegExp(a);var c=d.exec(window.location.search);if(c==null){return""}else{return decodeURIComponent(c[1].replace(/\+/g," "))}}function automatic_moment_update(){$(".automatic-moment").each(function(){var a=$(this).data("moment-timeout");if(a){$(this).html(moment(a).fromNow())}});setTimeout("automatic_moment_update()",1000)}function fetch_data(){var d=$("body").data("pagerefresh-data").content;$("#last_error").data("moment-timeout",d.autofill.lasterrortime*1000);$("#last_check").data("moment-timeout",d.autofill.lasttesttime*1000);var c=[],h=[],b=[],e=[];$.each(d.per_day,function(j,k){c.push(Math.floor(100*(k.uptime/864))/100);h.push(Math.floor(100*(k.unmonitored/864))/100);b.push(Math.floor(100*(k.downtime/864))/100);e.push(k.avgresponse)});$("#response_graph").empty();$("#response_graph").css("height",400).css("width",1000);$("#uptime_graph").empty();$("#uptime_graph").css("height",400).css("width",1000);var a=Raphael("uptime_graph"),i=function(){this.flag=a.popup(this.bar.x,this.bar.y,this.bar.value+"%"||"?%").insertBefore(this)},f=function(){this.flag=a.popup(this.bar.x,this.bar.y,this.bar.value+"ms"||"?ms").insertBefore(this)},g=function(){this.flag.remove()};a.barchart(0,10,900,400,[c,h,b],{stacked:true}).hover(i,g);var a=Raphael("response_graph");a.barchart(0,10,900,400,[e]).hover(f,g)}$(document).ready(function(){var a="per-check-"+getParameterByName("id")+".json";$("#update_data").pagerefresh({short_timeout:1*60,long_timeout:15*60,filewatch:a});automatic_moment_update()});